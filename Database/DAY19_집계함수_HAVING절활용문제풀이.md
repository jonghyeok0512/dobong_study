# 2026-01-26 SQL 학습 정리

## 1. 오늘 학습 요약
- SQL의 그룹화(`GROUP BY`)와 필터링 조건(`WHERE`, `HAVING`)의 차이점을 명확히 이해하고 실습함
- PostgreSQL 환경에서 실제 쿼리를 작성하며 집계 함수의 활용법을 익힘

## 2. 배운 개념 정리
- **WHERE 절**: 집계하기 전(그룹화 전)에 개별 행을 미리 필터링함. 인덱스 활용이 가능하여 성능 최적화에 유리함.
- **HAVING 절**: 집계가 완료된 후(그룹화 후) 결과 그룹에 대해 필터링 조건을 걸 때 사용함. 집계 함수(AVG, MIN, SUM 등)는 반드시 HAVING 절에서 조건으로 사용해야 함.
- **PostgreSQL 특징**: 표준 SQL을 잘 준수하며, 한글 별칭 사용 시 큰따옴표(`" "`)를 사용하는 것이 안전함.

## 3. 오늘 작성한 코드리뷰
```sql
/* 요구사항: 인구 50만 이상 도시들의 평균 인구가 100만 이상인 국가 조회
   - WHERE: 인구 50만 미만 도시를 미리 제외하여 계산 효율 높임
   - GROUP BY: 국가별로 데이터를 묶음
   - HAVING: 그룹화된 결과 중 평균 인구 조건을 만족하는 그룹만 추출
*/
SELECT 
    countrycode, 
    count(*) AS "총 도시수", -- 국가별 도시 개수 카운트
    SUM(population) AS "총 인구수" -- 국가별 인구 총합 계산
FROM city
WHERE population >= 500000 
GROUP BY countrycode
HAVING AVG(population) >= 1000000;
```

## 4. 실수/에러와 해결 과정
- **문제**: 처음에는 `AVG(population)` 조건을 `WHERE`절에 넣으려 했으나 에러 발생.
- **원인**: `WHERE`절은 개별 행을 검사하므로 그룹화된 결과인 집계 함수를 사용할 수 없음.
- **해결**: 그룹 조건은 반드시 `HAVING`절에 작성해야 함을 인지하고 쿼리 위치를 수정하여 해결함.

## 5. 실무관점의 참견 적용해보기
- **성능 최적화**: 데이터가 수백만 건 이상일 때는 `WHERE`절에서 최대한 데이터를 먼저 걸러내어 `GROUP BY`가 처리해야 할 양을 줄이는 것이 중요함.
- **가독성**: 별칭(Alias)에 `"총 도시수"`와 같이 명확한 한글 이름을 부여하면 협업 시 데이터 의미를 즉각적으로 전달할 수 있어 실무에서 권장되는 방식임.