# 2026-01-26 SQL 학습 정리 (dvdrental 실습 시작)

## 1. 오늘 학습 요약
- `world` DB 실습을 마무리하고, 더 복잡한 비즈니스 로직을 가진 `dvdrental` DB 실습으로 전환함
- `WHERE`절의 연산자 우선순위(`AND` vs `OR`)로 인한 데이터 오추출 문제를 해결하고 `IN` 연산자 활용법을 익힘
- `LIMIT`, `OFFSET`을 활용한 페이징 처리와 다중 정렬(`ORDER BY`) 실습을 진행함

## 2. 배운 개념 정리
- **연산자 우선순위**: SQL에서 `AND`는 `OR`보다 먼저 실행됨. 의도한 결과를 얻으려면 괄호`()`를 사용하거나 `IN` 연산자를 사용하는 것이 안전함.
- **PostgreSQL ILIKE**: 대소문자를 구분하지 않고 문자열 패턴을 매칭할 때 사용함 (`title ILIKE '%angel%'`).
- **Paging 처리**: `LIMIT`은 가져올 개수, `OFFSET`은 건너뛸 개수를 지정함. 게시판 페이징 시스템의 기초 원리임.
- **데이터 타입 이해**: `replacement_cost`(교체 비용)와 같은 수치형 데이터와 `rating`(등급) 같은 열거형 데이터를 다루는 법을 배움.

## 3. 오늘 작성한 코드리뷰
```sql
/* 오늘의 주요 코드 (12번, 13번 통합 리뷰)
   - 12번: 상영 시간 기준 내림차순 정렬 후, 시간이 같으면 제목순으로 2차 정렬. 11번째부터 5개 추출.
   - 13번: AND와 OR의 우선순위 문제를 IN 연산자로 해결하여 가독성과 정확성 확보.
*/

-- 12번: 페이징 및 다중 정렬
SELECT title, length 
FROM film
ORDER BY length DESC, title ASC 
LIMIT 5 OFFSET 10;

-- 13번: 복합 조건 필터링
SELECT title, rating, rental_duration 
FROM film
WHERE rental_duration <= 4 
  AND rating IN ('PG', 'G'); -- 괄호 우선순위 문제를 IN으로 깔끔하게 해결
```

## 4. 실수/에러와 해결 과정
- **문제**: `WHERE rental_duration <= 4 AND rating = 'PG' OR rating = 'G'` 쿼리 작성 시, 대여 기간과 상관없이 모든 'G' 등급 영화가 조회되는 현상 발생.
- **원인**: `AND`가 먼저 계산되어 `(기간 4 이하 AND PG)` 또는 `(G 등급 전체)`로 해석됨.
- **해결**: `rating IN ('PG', 'G')`를 사용하거나 `AND (rating = 'PG' OR rating = 'G')`와 같이 괄호를 사용하여 조건의 범위를 명확히 함.

## 5. 실무관점의 참견 적용해보기
- **안전한 쿼리 작성**: 실무에서 조건이 복잡해질 때 괄호를 생략하면 엉뚱한 데이터가 삭제되거나 수정될 위험이 있음. 연산자 우선순위를 과신하지 말고 명시적으로 괄호를 치거나 `IN`을 쓰는 습관이 중요함.
- **페이징의 중요성**: `LIMIT`과 `OFFSET` 없이 수만 건의 데이터를 한 번에 조회하면 서버 부하가 발생함. 사용자에게 보여줄 만큼만 끊어서 가져오는 방식은 성능 최적화의 기본임.
```
